---
title: "UNL03_exclusions"
format: docx
---

```{r setup, include=FALSE}
library(tidyverse)
library(afex)
library(BayesFactor)
library(apa)
library(papaja)
library(emmeans)
library(rstatix)
options(scipen = 999)
load("UNL03_proc_data.RData")
# function to force scientific formatting of numbers (used for large BFs)
changeSciNot <- function(n) {
  output <- format(n, scientific = TRUE, digits = 2) #Transforms the number into scientific notation even if small
  output <- sub("e", "x10^", output) #Replace e with 10^
  output <- sub("\\+0?", "", output) #Remove + symbol and leading zeros on exponent, if > 1
  output <- sub("-0?", "-", output) #Leaves - symbol but removes leading zeros on exponent, if < 1
  output <- paste0(output,"^")
  # output = strsplit(output, "^", fixed = TRUE)
  # output = paste0(output[[1]][1],"^", output[[1]][2], "^")
  output
}

# function to extract and report BFs with error %s
report_BF_and_error <- function(BF_in, sci_not = TRUE, hyp = "alt"){
  
  if (hyp == "alt") {
    BF_notation = "BF~10~ = "
  } else if (hyp == "null") {
    BF_notation = "BF~01~ = "
  }
  
  if (sci_not == TRUE) {
    BF_value = changeSciNot(extractBF(BF_in)$bf) # change to sci notation
  } else {
    BF_value = round(extractBF(BF_in)$bf,2) # otherwise round
  }
  
  paste0(BF_notation, 
         BF_value, 
         " &plusmn; ", 
         round(100*extractBF(BF_in)$error,2), 
         "%")
}

```
```{r, include=FALSE}
#filter participants that reported not enough attention
training <- filter(training, !pNum %in% notpassed$pNum)
test <- filter(test, !pNum %in% notpassed$pNum)
```
```{r, include=FALSE}
#Create probable response variable, as we are using the uncertain condition
training <- training %>%
  mutate(prob_response = case_when(cue1 == "A" & cue_o_mouse.clicked_name == "o1_image" ~ 1,
                                   cue1 == "A" & cue_o_mouse.clicked_name == "o2_image" ~ 0, 
                                   cue1 == "B" & cue_o_mouse.clicked_name == "o1_image" ~ 0,
                                   cue1 == "B" & cue_o_mouse.clicked_name == "o2_image" ~ 1))
```
```{r, include=FALSE}
#rank the participants (grouped by their condition) according to their PPR in block 6
p_block_avgs <- 
  training %>% 
  filter(block == 6) %>% 
  group_by(pNum, condition) %>% 
  summarise(mean_acc = mean(prob_response, na.rm = TRUE), 
            mean_rt = mean(cue_o_mouse.time, na.rm = TRUE)) %>% 
  group_by(condition) %>% 
  arrange(desc(mean_acc)) %>% 
  mutate(condition_rank = 1:n()) %>% #after this, filter the top 20 participants
  filter(condition_rank <= 20)
  

#filter from training and test dataframes those that made the rank
training <- filter(training, pNum %in% p_block_avgs$pNum)
test <- filter(test, pNum %in% p_block_avgs$pNum)
```

```{r, include=FALSE}
train <- training %>%
  group_by (pNum, block, stage, condition) %>%
  summarise(mean_response = mean(prob_response, na.rm = TRUE))
#Plot Training accuracy
MA_training <- train %>% 
  group_by(block, stage, condition) %>% 
  summarise(mean_prob_response = mean(mean_response, na.rm = TRUE),
            se_accuracy = sd(mean_response, na.rm = TRUE)/sqrt(length(mean_response)))
```
```{r, echo=FALSE}
ggplot(MA_training) +
  geom_point(mapping = aes(x = block, y = mean_prob_response, color = factor(condition, levels = c("C-C", "C-U", "U-U")))) +
  geom_line(mapping = aes(x = block, y = mean_prob_response, color = factor(condition, levels = c("C-C", "C-U", "U-U")))) +
  geom_errorbar(aes(x= block, y = mean_prob_response, ymin = mean_prob_response-se_accuracy, ymax = mean_prob_response+se_accuracy), color = "black", width=.1,position=position_dodge(0.05)) +
  geom_vline(xintercept = c(6.5, 10.5), linetype = "dashed", color = "black", linewidth = 1) +  # Vertical separator lines
  #facet_grid(cols = vars(stage), space = "free_x", scales = "free_x") + 
  scale_x_continuous(name = "Block", breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15)) +
  scale_y_continuous(name="Proportion of probable responses", limits=c(NA, 1)) +
  labs(title = "Mean proportion of probable responses on all training phases", color = "Group")+
  theme_apa()
```

```{r, include=FALSE}
#ANOVA
train <- training %>%
  group_by (pNum, block, condition) %>%
  summarise(mean_response = mean(prob_response, na.rm = TRUE))
train$pNum <- factor(train$pNum)
train$block <- factor(train$block)
train$condition <- factor(train$condition)
ANOVA_train <- aov_car(formula = mean_response ~ condition + Error(pNum/block), data = train)
print(ANOVA_train)

bay_ANOVA_train <- anovaBF(formula = mean_response ~ condition + block + pNum,
        data = data.frame(train),
        whichRandom = "pNum")
print(bay_ANOVA_train)
bay_ANOVA_train_int <- bay_ANOVA_train[4]/bay_ANOVA_train[3]
print(bay_ANOVA_train_int)
```
```{r, include = FALSE}
#Simple main effect of group on block
SME_group <- train %>%
  group_by(block) %>%
  anova_test(mean_response ~ condition) %>%
  get_anova_table() %>%
  adjust_pvalue(method = "bonferroni")
SME_group
```
```{r, include = FALSE}
#Simple main effect of condition on group  #####NOT WORKING
#SME_block <- train %>%
#  group_by(condition) %>%
#  anova_test(mean_response ~ block + Error(pNum/block), effect.size = "pes") %>%
#  get_anova_table() %>%
#  adjust_pvalue(method = "bonferroni")
#SME_block
```

```{r, include=FALSE}
stage1 <- filter(training, stage == "stage1")
stage2 <- filter(training, stage == "stage2")
stage3 <- filter(training, stage == "stage3")
```

## Stage 1 training

```{r, include=FALSE}
#ANOVA
resp_s1 <- stage1 %>%
  group_by (pNum, block, condition) %>%
  summarise(mean_response = mean(prob_response, na.rm = TRUE))
resp_s1$block <- factor(resp_s1$block)
resp_s1$condition <- factor(resp_s1$condition)
resp_s1$pNum <- factor(resp_s1$pNum)
ANOVA_resp_s1 <- aov_car(formula = mean_response ~ condition + Error(pNum/block), data = resp_s1)
print(ANOVA_resp_s1)

bay_ANOVA_resp_s1 <- anovaBF(formula = mean_response ~ condition + block + pNum,
        data = data.frame(resp_s1),
        whichRandom = "pNum")
print(bay_ANOVA_resp_s1)
bay_ANOVA_resp_s1_int <- bay_ANOVA_resp_s1[4]/bay_ANOVA_resp_s1[3]
print(bay_ANOVA_resp_s1_int)
```
```{r, include=FALSE}
#Simple comparisons for group
ANOVA_s1_cond <-emmeans(ANOVA_resp_s1, ~condition)
pw_ANOVA_s1 <- pairs(ANOVA_s1_cond, adj = "bonferroni")
print(pw_ANOVA_s1)
```


In stage 1, there was a significant effect of the *block*, `r apa(ANOVA_resp_s1, effect = "block")`, `r report_BF_and_error(bay_ANOVA_resp_s1[1])` and of the *condition*, `r apa(ANOVA_resp_s1, effect = "condition" )`, `r report_BF_and_error(bay_ANOVA_resp_s1[2])`, but not of the *block x condition* interaction, `r apa(ANOVA_resp_s1, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_resp_s1_int[1])`. Diffs between C-C and C-U with U-U.
 
## Stage 2 training

```{r, include=FALSE}
#ANOVA
resp_s2 <- stage2 %>%
  group_by (pNum, block, condition) %>%
  summarise(mean_response = mean(prob_response, na.rm = TRUE))
resp_s2$block <- factor(resp_s2$block)
resp_s2$condition <- factor(resp_s2$condition)
resp_s2$pNum <- factor(resp_s2$pNum)
ANOVA_resp_s2 <- aov_car(formula = mean_response ~ condition + Error(pNum/block), data = resp_s2)
print(ANOVA_resp_s2)

bay_ANOVA_resp_s2 <- anovaBF(formula = mean_response ~ condition + block + pNum,
        data = data.frame(resp_s2),
        whichRandom = "pNum")
print(bay_ANOVA_resp_s2)
bay_ANOVA_resp_s2_int <- bay_ANOVA_resp_s2[4]/bay_ANOVA_resp_s2[3]
print(bay_ANOVA_resp_s2_int)
```
```{r, include=FALSE}
#Simple comparisons for group
ANOVA_s2_cond <-emmeans(ANOVA_resp_s2, ~condition)
pw_ANOVA_s2 <- pairs(ANOVA_s2_cond, adj = "bonferroni")
print(pw_ANOVA_s2)
```

Significant effect of *group*, `r apa(ANOVA_resp_s2, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_resp_s2[2])`, but not of *block* (`r apa(ANOVA_resp_s2, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_resp_s2[1])`), nor *group x block* interaction, `r apa(ANOVA_resp_s2, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_resp_s2_int[1])`. Differences between groups C-U and U-U with C-C

## Stage 3

```{r, include=FALSE}
#ANOVA
resp_s3 <- stage3 %>%
  group_by (pNum, block, condition) %>%
  summarise(mean_response = mean(prob_response, na.rm = TRUE))
resp_s3$condition <- factor(resp_s3$condition)
resp_s3$block <- factor(resp_s3$block)
resp_s3$pNum <- factor(resp_s3$pNum)
ANOVA_resp_s3 <- aov_car(formula = mean_response ~ condition + Error(pNum/block), data = resp_s3)
print(ANOVA_resp_s3)

bay_ANOVA_resp_s3 <- anovaBF(formula = mean_response ~ condition + block + pNum,
        data = data.frame(resp_s3), 
        whichRandom = "pNum")
print(bay_ANOVA_resp_s3)
bay_ANOVA_resp_s3_int <- bay_ANOVA_resp_s3[4]/bay_ANOVA_resp_s3[3]
print(bay_ANOVA_resp_s3_int)
```
```{r, include=FALSE}
#Simple comparisons for group
ANOVA_s3_cond <-emmeans(ANOVA_resp_s3, ~condition)
pw_ANOVA_s3 <- pairs(ANOVA_s3_cond, adj = "bonferroni")
print(pw_ANOVA_s3)
```

Sig *group*  `r apa(ANOVA_resp_s3, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_resp_s3[2])`, sig *block*, `r apa(ANOVA_resp_s3, effect = "block")`, `r report_BF_and_error(bay_ANOVA_resp_s3[1])`, no sig *blockxgroup* interaction, `r apa(ANOVA_resp_s3, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_resp_s3_int[1])`. No significant pairwise differences.

# All test trials

```{r, include=FALSE}
#fix missing values
test$O1_rating[is.na(test$O1_rating)] <- 4
test$O2_rating[is.na(test$O2_rating)] <- 4
```

## Difference score
```{r, include=FALSE}
test <- test %>%
  mutate(predictiveness = case_when(testcue == "A" | testcue == "B" ~ "P",
                                    testcue == "X" | testcue == "Y" ~ "NP"),
         difscore = case_when(testcue == "A" | testcue == "X"  ~ (O1_rating - O2_rating),
                              testcue == "B" | testcue == "Y" ~ (O2_rating - O1_rating)))
```
```{r, include=FALSE}
M_test <- test %>%
  group_by(pNum, block, condition, predictiveness) %>%
  summarise(mean_dif = mean(difscore, na.rm = TRUE))
MD_test <- M_test %>%
  group_by(block, condition, predictiveness) %>%
  summarise(mean = mean(mean_dif, na.rm = TRUE),
            se = sd(mean_dif, na.rm = TRUE)/sqrt(length(mean_dif)))
```
```{r, echo=FALSE}
ggplot(MD_test) +
  geom_point(mapping = aes(x = block, y = mean, color = factor(condition, levels = c("C-C", "C-U", "U-U")), shape = predictiveness)) +
  geom_line(mapping = aes(x = block, y = mean, color = factor(condition, levels = c("C-C", "C-U", "U-U")), linetype = predictiveness)) +
  geom_errorbar(aes(x= block, y = mean, ymin = mean-se, ymax = mean+se), color = "black", width=.1,position=position_dodge(0.05)) +
  geom_vline(xintercept = c(3.5, 5.5), linetype = "dashed", color = "black", size = 1) +  # Vertical separator lines
  scale_x_continuous(name = "Block", breaks = c(1, 2, 3, 4, 5, 6, 7, 8)) +
  #scale_y_continuous(name="Diference score", limits=c(-6, 6)) +
  labs(title = "Mean diference scores in all test trials", color = "Group")+
  theme_apa()
```
```{r, include=FALSE}
#ANOVA
M_test$pNum <- factor(M_test$pNum)
M_test$block <- factor(M_test$block)
M_test$condition <- factor(M_test$condition)
M_test$predictiveness <- factor(M_test$predictiveness)
ANOVA_test <- aov_car(formula = mean_dif ~ condition + Error(pNum/block*predictiveness), data = M_test)
print(ANOVA_test)

bay_ANOVA_test <- anovaBF(formula = mean_dif ~ condition + block + predictiveness + pNum,
        data = data.frame(M_test),
        whichRandom = "pNum")
print(bay_ANOVA_test)
bay_ANOVA_test_gxb <- bay_ANOVA_test[4]/bay_ANOVA_test[3]
print(bay_ANOVA_test_gxb)
bay_ANOVA_test_bxp <- bay_ANOVA_test[10]/bay_ANOVA_test[6]
print(bay_ANOVA_test_bxp)
bay_ANOVA_test_gxp <- bay_ANOVA_test[13]/bay_ANOVA_test[7]
print(bay_ANOVA_test_gxp)
bay_ANOVA_test_gxbxp <- bay_ANOVA_test[18]/bay_ANOVA_test[17]
print(bay_ANOVA_test_gxbxp)
```
```{r, include = FALSE}
# SME of the group::block interaction
SME_M_test <- M_test %>%
  group_by (pNum, condition, block) %>%
  summarise(mean_dif = mean(mean_dif, na.rm = TRUE))
#Simple main effect of group on block
SME_M_test_group <- SME_M_test %>%
  group_by(block) %>%
  anova_test(mean_dif ~ condition) %>%
  get_anova_table() %>%
  adjust_pvalue(method = "bonferroni")
SME_M_test_group
```
```{r, include = FALSE}
#Simple main effect of condition on group
SME_M_test_block <- SME_M_test %>%
  group_by(condition) %>%
  anova_test(mean_dif ~ block + Error(pNum/block), effect.size = "pes") %>%
  get_anova_table() %>%
  adjust_pvalue(method = "bonferroni")
SME_M_test_block
```

A mixed model ANOVA, with the between subjects factor *group* and the within subjects factors *block* and *predictiveness* 
*group*, `r apa(ANOVA_test, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_test[2])`
*block*,`r apa(ANOVA_test, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_test[1])`,
*predictiveness*, `r apa(ANOVA_test, effect = "predictiveness" )`, `r report_BF_and_error(bay_ANOVA_test[5])` 
*group x block* interaction, `r apa(ANOVA_test, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_test_gxb[1])`,
*group x predictiveness* interaction, `r apa(ANOVA_test, effect = "condition:predictiveness")`, `r report_BF_and_error(bay_ANOVA_test_gxp[1])`,
*block x predictiveness* interaction, `r apa(ANOVA_test, effect = "block:predictiveness")`, `r report_BF_and_error(bay_ANOVA_test_bxp[1])`,
*group x block x predictiveness* interaction, `r apa(ANOVA_test, effect = "condition:block:predictiveness")`, `r report_BF_and_error(bay_ANOVA_test_gxbxp[1])`

```{r, include=FALSE}
stage1_test <- filter(test, stage == "stage1")
stage2_test <- filter(test, stage == "stage2")
stage3_test <- filter(test, stage == "stage3")
```

### Stage 1 test

```{r, include=FALSE}
#ANOVA
s1_test <- stage1_test %>%
  group_by (pNum, block, condition, predictiveness) %>%
  summarise(mean_dif = mean(difscore, na.rm = TRUE))
s1_test$predictiveness <- factor(s1_test$predictiveness)
s1_test$block <- factor(s1_test$block)
s1_test$condition <- factor(s1_test$condition)
s1_test$pNum <- factor(s1_test$pNum)
ANOVA_s1_test <- aov_car(formula = mean_dif ~ condition + Error(pNum/block*predictiveness), data = s1_test)
print(ANOVA_s1_test)

bay_ANOVA_s1_test <- anovaBF(formula = mean_dif ~ condition + block + predictiveness + pNum,
        data = data.frame(s1_test),
        whichRandom = "pNum")
print(bay_ANOVA_s1_test)
bay_ANOVA_s1_test_gxb <- bay_ANOVA_s1_test[4]/bay_ANOVA_s1_test[3]
print(bay_ANOVA_s1_test_gxb)
bay_ANOVA_s1_test_bxp <- bay_ANOVA_s1_test[10]/bay_ANOVA_s1_test[6]
print(bay_ANOVA_s1_test_bxp)
bay_ANOVA_s1_test_gxp <- bay_ANOVA_s1_test[13]/bay_ANOVA_s1_test[7]
print(bay_ANOVA_s1_test_gxp)
bay_ANOVA_s1_test_gxbxp <- bay_ANOVA_s1_test[18]/bay_ANOVA_s1_test[17]
print(bay_ANOVA_s1_test_gxbxp)
```
```{r, include = FALSE}
# SME of the group::predictiveness interaction
SME_s1_test <- s1_test %>%
  group_by (pNum, condition, predictiveness) %>%
  summarise(mean_dif = mean(mean_dif, na.rm = TRUE))
#Simple main effect of group on predictiveness
SME_s1_test_group <- SME_s1_test %>%
  group_by(predictiveness) %>%
  anova_test(mean_dif ~ condition) %>%
  get_anova_table() %>%
  adjust_pvalue(method = "bonferroni")
SME_s1_test_group
```
```{r, include = FALSE}
#Simple main effect of predictiveness on group
SME_s1_test_pred <- SME_s1_test %>%
  group_by(condition) %>%
  anova_test(mean_dif ~ predictiveness + Error(pNum/predictiveness), effect.size = "pes") %>%
  get_anova_table() %>%
  adjust_pvalue(method = "bonferroni")
SME_s1_test_pred
```
```{r, include=FALSE}
#Simple comparisons for time
sc_s1_group <- SME_s1_test %>%
  group_by(predictiveness) %>%
  pairwise_t_test(
    mean_dif ~ condition, 
    paired = TRUE,
    p.adjust.method = "bonferroni"
    )

#Call the summary
sc_s1_group
```

Mixed model ANOVA with the between factor *group* (C-C, C-U and U-U), and within factors *block* and *predictiveness* (P vs NP)
*group*, `r apa(ANOVA_s1_test, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_s1_test[2])`
*block*,`r apa(ANOVA_s1_test, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_s1_test[1])`,
*predictiveness*, `r apa(ANOVA_s1_test, effect = "predictiveness" )`, `r report_BF_and_error(bay_ANOVA_s1_test[5])` 
*group x block* interaction, `r apa(ANOVA_s1_test, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_s1_test_gxb[1])`,
*group x predictiveness* interaction, `r apa(ANOVA_s1_test, effect = "condition:predictiveness")`, `r report_BF_and_error(bay_ANOVA_s1_test_gxp[1])`,
*block x predictiveness* interaction, `r apa(ANOVA_s1_test, effect = "block:predictiveness")`, `r report_BF_and_error(bay_ANOVA_s1_test_bxp[1])`,
*group x block x predictiveness* interaction, `r apa(ANOVA_s1_test, effect = "condition:block:predictiveness")`, `r report_BF_and_error(bay_ANOVA_s1_test_gxbxp[1])`
 
### Stage 2 test

```{r, include=FALSE}
#ANOVA
s2_test <- stage2_test %>%
  group_by (pNum, block, condition, predictiveness) %>%
  summarise(mean_dif= mean(difscore, na.rm = TRUE))
s2_test$predictiveness <- factor(s2_test$predictiveness)
s2_test$block <- factor(s2_test$block)
s2_test$condition <- factor(s2_test$condition)
s2_test$pNum <- factor(s2_test$pNum)
ANOVA_s2_test <- aov_car(formula = mean_dif ~ condition + Error(pNum/block*predictiveness), data = s2_test)
print(ANOVA_s2_test)

bay_ANOVA_s2_test <- anovaBF(formula = mean_dif ~ condition + block + predictiveness + pNum,
        data = data.frame(s2_test),
        whichRandom = "pNum")
print(bay_ANOVA_s2_test)
bay_ANOVA_s2_test_gxb <- bay_ANOVA_s2_test[4]/bay_ANOVA_s2_test[3]
print(bay_ANOVA_s2_test_gxb)
bay_ANOVA_s2_test_bxp <- bay_ANOVA_s2_test[10]/bay_ANOVA_s2_test[6]
print(bay_ANOVA_s2_test_bxp)
bay_ANOVA_s2_test_gxp <- bay_ANOVA_s2_test[13]/bay_ANOVA_s2_test[7]
print(bay_ANOVA_s2_test_gxp)
bay_ANOVA_s2_test_gxbxp <- bay_ANOVA_s2_test[18]/bay_ANOVA_s2_test[17]
print(bay_ANOVA_s2_test_gxbxp)
```
```{r, include=FALSE}
#Simple comparisons for group
ANOVA_s2_cond <-emmeans(ANOVA_s2_test, ~condition)
pw_ANOVA_s2 <- pairs(ANOVA_s2_cond, adj = "bonferroni")
print(pw_ANOVA_s2)
```
```{r, include = FALSE}
# SME of the group::predictiveness interaction
SME_s2_test <- s2_test %>%
  group_by (pNum, condition, predictiveness) %>%
  summarise(mean_dif = mean(mean_dif, na.rm = TRUE))
#Simple main effect of group on predictiveness
SME_s2_test_group <- SME_s2_test %>%
  group_by(predictiveness) %>%
  anova_test(mean_dif ~ condition) %>%
  get_anova_table() %>%
  adjust_pvalue(method = "bonferroni")
SME_s2_test_group
```
```{r, include = FALSE}
#Simple main effect of predictiveness on group
SME_s2_test_pred <- SME_s2_test %>%
  group_by(condition) %>%
  anova_test(mean_dif ~ predictiveness + Error(pNum/predictiveness), effect.size = "pes") %>%
  get_anova_table() %>%
  adjust_pvalue(method = "bonferroni")
SME_s2_test_pred
```
```{r, include=FALSE}
#Simple comparisons for time
sc_s2_group <- SME_s2_test %>%
  group_by(predictiveness) %>%
  pairwise_t_test(
    mean_dif ~ condition, 
    paired = TRUE,
    p.adjust.method = "bonferroni"
    )

#Call the summary
sc_s2_group
```

Mixed model ANOVA with the between factor *group* (C-C, C-U and U-U), and within factors *block* and *predictiveness* (P vs NP)
*group*, `r apa(ANOVA_s2_test, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_s2_test[2])`
*block*,`r apa(ANOVA_s2_test, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_s2_test[1])`,
*predictiveness*, `r apa(ANOVA_s2_test, effect = "predictiveness" )`, `r report_BF_and_error(bay_ANOVA_s2_test[5])` 
*group x block* interaction, `r apa(ANOVA_s2_test, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_s2_test_gxb[1])`,
*group x predictiveness* interaction, `r apa(ANOVA_s2_test, effect = "condition:predictiveness")`, `r report_BF_and_error(bay_ANOVA_s2_test_gxp[1])`,
*block x predictiveness* interaction, `r apa(ANOVA_s2_test, effect = "block:predictiveness")`, `r report_BF_and_error(bay_ANOVA_s2_test_bxp[1])`,
*group x block x predictiveness* interaction, `r apa(ANOVA_s2_test, effect = "condition:block:predictiveness")`, `r report_BF_and_error(bay_ANOVA_s2_test_gxbxp[1])`

### Stage 3 test

```{r, include=FALSE}
#ANOVA
s3_test <- stage3_test %>%
  group_by (pNum, block, condition, predictiveness) %>%
  summarise(mean_dif= mean(difscore, na.rm = TRUE))
s3_test$predictiveness <- factor(s3_test$predictiveness)
s3_test$condition <- factor(s3_test$condition)
s3_test$block <- factor(s3_test$block)
s3_test$pNum <- factor(s3_test$pNum)
ANOVA_s3_test <- aov_car(formula = mean_dif ~ condition + Error(pNum/block*predictiveness), data = s3_test)
print(ANOVA_s3_test)

bay_ANOVA_s3_test <- anovaBF(formula = mean_dif ~ condition + block + predictiveness + pNum,
        data = data.frame(s3_test), 
        whichRandom = "pNum")
print(bay_ANOVA_s3_test)
bay_ANOVA_s3_test_gxb <- bay_ANOVA_s3_test[4]/bay_ANOVA_s3_test[3]
print(bay_ANOVA_s3_test_gxb)
bay_ANOVA_s3_test_bxp <- bay_ANOVA_s3_test[10]/bay_ANOVA_s3_test[6]
print(bay_ANOVA_s3_test_bxp)
bay_ANOVA_s3_test_gxp <- bay_ANOVA_s3_test[13]/bay_ANOVA_s3_test[7]
print(bay_ANOVA_s3_test_gxp)
bay_ANOVA_s3_test_gxbxp <- bay_ANOVA_s3_test[18]/bay_ANOVA_s3_test[17]
print(bay_ANOVA_s3_test_gxbxp)
```
```{r, include = FALSE}
# SME of the group::predictiveness interaction
SME_s3_test <- s3_test %>%
  group_by (pNum, condition, predictiveness) %>%
  summarise(mean_dif = mean(mean_dif, na.rm = TRUE))
#Simple main effect of group on predictiveness
SME_s3_test_group <- SME_s3_test %>%
  group_by(predictiveness) %>%
  anova_test(mean_dif ~ condition) %>%
  get_anova_table() %>%
  adjust_pvalue(method = "bonferroni")
SME_s3_test_group
```
```{r, include = FALSE}
#Simple main effect of predictiveness on group
SME_s3_test_pred <- SME_s3_test %>%
  group_by(condition) %>%
  anova_test(mean_dif ~ predictiveness + Error(pNum/predictiveness), effect.size = "pes") %>%
  get_anova_table() %>%
  adjust_pvalue(method = "bonferroni")
SME_s3_test_pred
```
```{r, include=FALSE}
#Simple comparisons for time
sc_s3_group <- SME_s3_test %>%
  group_by(predictiveness) %>%
  pairwise_t_test(
    mean_dif ~ condition, 
    paired = TRUE,
    p.adjust.method = "bonferroni"
    )

#Call the summary
sc_s3_group
```

Mixed model ANOVA with the between factor *group* (C-C, C-U and U-U), and within factors *block* and *predictiveness* (P vs NP)
*group*, `r apa(ANOVA_s3_test, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_s3_test[2])`
*block*,`r apa(ANOVA_s3_test, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_s3_test[1])`,
*predictiveness*, `r apa(ANOVA_s3_test, effect = "predictiveness" )`, `r report_BF_and_error(bay_ANOVA_s3_test[5])` 
*group x block* interaction, `r apa(ANOVA_s3_test, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_s3_test_gxb[1])`,
*group x predictiveness* interaction, `r apa(ANOVA_s3_test, effect = "condition:predictiveness")`, `r report_BF_and_error(bay_ANOVA_s3_test_gxp[1])`,
*block x predictiveness* interaction, `r apa(ANOVA_s3_test, effect = "block:predictiveness")`, `r report_BF_and_error(bay_ANOVA_s3_test_bxp[1])`,
*group x block x predictiveness* interaction, `r apa(ANOVA_s3_test, effect = "condition:block:predictiveness")`, `r report_BF_and_error(bay_ANOVA_s3_test_gxbxp[1])`

```{r, include=FALSE}
test_NP <- filter(test, predictiveness == "NP")
test_P <- filter(test, predictiveness == "P")
```

# Non-predictive
```{r, include=FALSE}
#ANOVA
M_test_NP <- test_NP %>%
  group_by (pNum, block, condition) %>%
  summarise(mean_dif = mean(difscore, na.rm = TRUE))
M_test_NP$pNum <- factor(M_test_NP$pNum)
M_test_NP$block <- factor(M_test_NP$block)
M_test_NP$condition <- factor(M_test_NP$condition)
ANOVA_test_NP <- aov_car(formula = mean_dif ~ condition + Error(pNum/block), data = M_test_NP)
print(ANOVA_test_NP)

bay_ANOVA_test_NP <- anovaBF(formula = mean_dif ~ condition + block + pNum,
        data = data.frame(M_test_NP),
        whichRandom = "pNum")
print(bay_ANOVA_test_NP)
bay_ANOVA_test_NP_gxb <- bay_ANOVA_test_NP[4]/bay_ANOVA_test_NP[3]
print(bay_ANOVA_test_NP_gxb)
```
A mixed model ANOVA, with the between subjects factor *group* and the within subjects factors *block* and *predictiveness* 
*group*, `r apa(ANOVA_test_NP, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_test_NP[2])`
*block*,`r apa(ANOVA_test_NP, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_test_NP[1])`,
*group x block* interaction, `r apa(ANOVA_test_NP, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_test_NP_gxb[1])`,

```{r, include=FALSE}
stage1_test_NP <- filter(test_NP, stage == "stage1")
stage2_test_NP <- filter(test_NP, stage == "stage2")
stage3_test_NP <- filter(test_NP, stage == "stage3")
```

### Stage 1

```{r, include=FALSE}
#ANOVA
s1_test_NP <- stage1_test_NP %>%
  group_by (pNum, block, condition) %>%
  summarise(mean_dif = mean(difscore, na.rm = TRUE))
s1_test_NP$block <- factor(s1_test_NP$block)
s1_test_NP$condition <- factor(s1_test_NP$condition)
s1_test_NP$pNum <- factor(s1_test_NP$pNum)
ANOVA_s1_test_NP <- aov_car(formula = mean_dif ~ condition + Error(pNum/block), data = s1_test_NP)
print(ANOVA_s1_test_NP)

bay_ANOVA_s1_test_NP <- anovaBF(formula = mean_dif ~ condition + block + pNum,
        data = data.frame(s1_test),
        whichRandom = "pNum")
print(bay_ANOVA_s1_test_NP)
bay_ANOVA_s1_test_NP_gxb <- bay_ANOVA_s1_test_NP[4]/bay_ANOVA_s1_test_NP[3]
print(bay_ANOVA_s1_test_NP_gxb)
```

Mixed model ANOVA with the between factor *group* (C-C, C-U and U-U), and within factors *block*
*group*, `r apa(ANOVA_s1_test_NP, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_s1_test_NP[2])`
*block*,`r apa(ANOVA_s1_test_NP, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_s1_test_NP[1])`,
*group x block* interaction, `r apa(ANOVA_s1_test_NP, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_s1_test_NP_gxb[1])`,
 
### Stage 2 test

```{r, include=FALSE}
#ANOVA
s2_test_NP <- stage2_test_NP %>%
  group_by (pNum, block, condition) %>%
  summarise(mean_dif= mean(difscore, na.rm = TRUE))
s2_test_NP$block <- factor(s2_test_NP$block)
s2_test_NP$condition <- factor(s2_test_NP$condition)
s2_test_NP$pNum <- factor(s2_test_NP$pNum)
ANOVA_s2_test_NP <- aov_car(formula = mean_dif ~ condition + Error(pNum/block), data = s2_test_NP)
print(ANOVA_s2_test_NP)

bay_ANOVA_s2_test_NP <- anovaBF(formula = mean_dif ~ condition + block + pNum,
        data = data.frame(s2_test_NP),
        whichRandom = "pNum")
print(bay_ANOVA_s2_test_NP)
bay_ANOVA_s2_test_NP_gxb <- bay_ANOVA_s2_test_NP[4]/bay_ANOVA_s2_test_NP[3]
print(bay_ANOVA_s2_test_NP_gxb)
```

Mixed model ANOVA with the between factor *group* (C-C, C-U and U-U), and within factors *block* and *predictiveness* (P vs NP)
*group*, `r apa(ANOVA_s2_test_NP, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_s2_test_NP[2])`
*block*,`r apa(ANOVA_s2_test_NP, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_s2_test_NP[1])`,
*group x block* interaction, `r apa(ANOVA_s2_test_NP, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_s2_test_NP_gxb[1])`,

### Stage 3 test

```{r, include=FALSE}
#ANOVA
s3_test_NP <- stage3_test_NP %>%
  group_by (pNum, block, condition) %>%
  summarise(mean_dif= mean(difscore, na.rm = TRUE))
s3_test_NP$condition <- factor(s3_test_NP$condition)
s3_test_NP$block <- factor(s3_test_NP$block)
s3_test_NP$pNum <- factor(s3_test_NP$pNum)
ANOVA_s3_test_NP <- aov_car(formula = mean_dif ~ condition + Error(pNum/block), data = s3_test_NP)
print(ANOVA_s3_test_NP)

bay_ANOVA_s3_test_NP <- anovaBF(formula = mean_dif ~ condition + block + pNum,
        data = data.frame(s3_test_NP), 
        whichRandom = "pNum")
print(bay_ANOVA_s3_test_NP)
bay_ANOVA_s3_test_NP_gxb <- bay_ANOVA_s3_test_NP[4]/bay_ANOVA_s3_test_NP[3]
print(bay_ANOVA_s3_test_NP_gxb)

```

```{r, include=FALSE}
#Simple comparisons for group
ANOVA_s3_cond <-emmeans(ANOVA_s3_test_NP, ~condition)
pw_ANOVA_s3 <- pairs(ANOVA_s3_cond, adj = "bonferroni")
print(pw_ANOVA_s3)
```

Mixed model ANOVA with the between factor *group* (C-C, C-U and U-U), and within factors *block* and *predictiveness* (P vs NP)
*group*, `r apa(ANOVA_s3_test_NP, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_s3_test_NP[2])`
*block*,`r apa(ANOVA_s3_test_NP, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_s3_test_NP[1])`, 
*group x block* interaction, `r apa(ANOVA_s3_test_NP, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_s3_test_NP_gxb[1])`,


## Predictive
```{r, include=FALSE}
#ANOVA
M_test_P <- test_P %>%
  group_by (pNum, block, condition) %>%
  summarise(mean_dif = mean(difscore, na.rm = TRUE))
M_test_P$pNum <- factor(M_test_P$pNum)
M_test_P$block <- factor(M_test_P$block)
M_test_P$condition <- factor(M_test_P$condition)
ANOVA_test_P <- aov_car(formula = mean_dif ~ condition + Error(pNum/block), data = M_test_P)
print(ANOVA_test_P)

bay_ANOVA_test_P <- anovaBF(formula = mean_dif ~ condition + block + pNum,
        data = data.frame(M_test_P),
        whichRandom = "pNum")
print(bay_ANOVA_test_P)
bay_ANOVA_test_P_gxb <- bay_ANOVA_test_P[4]/bay_ANOVA_test_P[3]
print(bay_ANOVA_test_P_gxb)
```

```{r, include = FALSE}
#Simple main effect of group on block
SME_test_P_group <- M_test_P %>%
  group_by(block) %>%
  anova_test(mean_dif ~ condition, effect.size = "pes") %>%
  get_anova_table() %>%
  adjust_pvalue(method = "bonferroni")
SME_test_P_group
```
```{r, include = FALSE}
#Simple main effect of condition on group
SME_test_P_block <- M_test_P %>%
  group_by(condition) %>%
  anova_test(mean_dif ~ block + Error(pNum/block), effect.size = "pes") %>%
  get_anova_table() %>%
  adjust_pvalue(method = "bonferroni")
SME_test_P_block
```

A mixed model ANOVA, with the between subjects factor *group* and the within subjects factors *block* and *predictiveness* 
*group*, `r apa(ANOVA_test_P, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_test_P[2])`
*block*,`r apa(ANOVA_test_P, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_test_P[1])`,
*group x block* interaction, `r apa(ANOVA_test_P, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_test_P_gxb[1])`,

```{r, include=FALSE}
stage1_test_P <- filter(test_P, stage == "stage1")
stage2_test_P <- filter(test_P, stage == "stage2")
stage3_test_P <- filter(test_P, stage == "stage3")
```

### Stage 1

```{r, include=FALSE}
#ANOVA
s1_test_P <- stage1_test_P %>%
  group_by (pNum, block, condition) %>%
  summarise(mean_dif = mean(difscore, na.rm = TRUE))
s1_test_P$block <- factor(s1_test_P$block)
s1_test_P$condition <- factor(s1_test_P$condition)
s1_test_P$pNum <- factor(s1_test_P$pNum)
ANOVA_s1_test_P <- aov_car(formula = mean_dif ~ condition + Error(pNum/block), data = s1_test_P)
print(ANOVA_s1_test_P)

bay_ANOVA_s1_test_P <- anovaBF(formula = mean_dif ~ condition + block + pNum,
        data = data.frame(s1_test_P),
        whichRandom = "pNum")
print(bay_ANOVA_s1_test_P)
bay_ANOVA_s1_test_P_gxb <- bay_ANOVA_s1_test_P[4]/bay_ANOVA_s1_test_P[3]
print(bay_ANOVA_s1_test_P_gxb)
```
```{r, include=FALSE}
ANOVA_s1_test_P_int <- emmeans(ANOVA_s1_test_P, ~condition)
pairs(ANOVA_s1_test_P_int, adj = "bonferroni")
```

Mixed model ANOVA with the between factor *group* (C-C, C-U and U-U), and within factors *block* and *predictiveness* (P vs NP)
*group*, `r apa(ANOVA_s1_test_P, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_s1_test_P[2])`
*block*,`r apa(ANOVA_s1_test_P, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_s1_test_P[1])`, 
*group x block* interaction, `r apa(ANOVA_s1_test_P, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_s1_test_P_gxb[1])`,
 
### Stage 2 test

```{r, include=FALSE}
#ANOVA
s2_test_P <- stage2_test_P %>%
  group_by (pNum, block, condition) %>%
  summarise(mean_dif= mean(difscore, na.rm = TRUE))
s2_test_P$block <- factor(s2_test_P$block)
s2_test_P$condition <- factor(s2_test_P$condition)
s2_test_P$pNum <- factor(s2_test_P$pNum)
ANOVA_s2_test_P <- aov_car(formula = mean_dif ~ condition + Error(pNum/block), data = s2_test_P)
print(ANOVA_s2_test_P)

bay_ANOVA_s2_test_P <- anovaBF(formula = mean_dif ~ condition + block + pNum,
        data = data.frame(s2_test_P),
        whichRandom = "pNum")
print(bay_ANOVA_s2_test_P)
bay_ANOVA_s2_test_P_gxb <- bay_ANOVA_s2_test_P[4]/bay_ANOVA_s2_test_P[3]
print(bay_ANOVA_s2_test_P_gxb)
```

```{r, include=FALSE}
#Simple comparisons for group
ANOVA_s2_cond <-emmeans(ANOVA_s2_test_P, ~condition)
pw_ANOVA_s2 <- pairs(ANOVA_s2_cond, adj = "bonferroni")
print(pw_ANOVA_s2)
```

Mixed model ANOVA with the between factor *group* (C-C, C-U and U-U), and within factors *block* and *predictiveness* (P vs NP)
*group*, `r apa(ANOVA_s2_test_P, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_s2_test_P[2])`
*block*,`r apa(ANOVA_s2_test_P, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_s2_test_P[1])`,
*group x block* interaction, `r apa(ANOVA_s2_test_P, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_s2_test_P_gxb[1])`,

### Stage 3 test

```{r, include=FALSE}
#ANOVA
s3_test_P <- stage3_test_P %>%
  group_by (pNum, block, condition) %>%
  summarise(mean_dif= mean(difscore, na.rm = TRUE))
s3_test_P$condition <- factor(s3_test_P$condition)
s3_test_P$block <- factor(s3_test_P$block)
s3_test_P$pNum <- factor(s3_test_P$pNum)
ANOVA_s3_test_P <- aov_car(formula = mean_dif ~ condition + Error(pNum/block), data = s3_test_P)
print(ANOVA_s3_test_P)

bay_ANOVA_s3_test_P <- anovaBF(formula = mean_dif ~ condition + block + pNum,
        data = data.frame(s3_test_P), 
        whichRandom = "pNum")
print(bay_ANOVA_s3_test_P)
bay_ANOVA_s3_test_P_gxb <- bay_ANOVA_s3_test_P[4]/bay_ANOVA_s3_test_P[3]
print(bay_ANOVA_s3_test_P_gxb)
```

Mixed model ANOVA with the between factor *group* (C-C, C-U and U-U), and within factors *block* and *predictiveness* (P vs NP)
*group*, `r apa(ANOVA_s3_test_P, effect = "condition")`, `r report_BF_and_error(bay_ANOVA_s3_test_P[2])`
*block*,`r apa(ANOVA_s3_test_P, effect = "block" )`, `r report_BF_and_error(bay_ANOVA_s3_test_P[1])`,
*group x block* interaction, `r apa(ANOVA_s3_test_P, effect = "condition:block")`, `r report_BF_and_error(bay_ANOVA_s3_test_P_gxb[1])`